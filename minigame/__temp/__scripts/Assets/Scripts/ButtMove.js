"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var engine_1 = require("engine");
var eventCenter_1 = require("./eventCenter");
var SCREEN_WIDTH = engine_1.default.device.screenWidth;
var SCREEN_HEIGHT = engine_1.default.device.screenHeight;
var GAME_WIDTH = engine_1.default.adaptation.frameWidth;
var GAME_HEIGHT = engine_1.default.adaptation.frameHeight;
var ButtMove = (function (_super) {
    tslib_1.__extends(ButtMove, _super);
    function ButtMove(entity) {
        var _this = _super.call(this, entity) || this;
        _this.entity = entity;
        _this.buttonPos = engine_1.default.Vector2.ZERO.clone();
        _this.buttonRadius = { x: 0, y: 0 };
        _this.direction = engine_1.default.Vector2.ZERO.clone();
        _this.uisprite = null;
        _this.uiInput = null;
        _this.onTouchStart = _this.onTouchStart.bind(_this);
        _this.onTouchEnter = _this.onTouchEnter.bind(_this);
        _this.onTouchMove = _this.onTouchMove.bind(_this);
        _this.onTouchEnd = _this.onTouchEnd.bind(_this);
        _this.onTouchLeave = _this.onTouchLeave.bind(_this);
        return _this;
    }
    ButtMove.prototype.onAwake = function () {
        this.uisprite = this.entity.getComponent(engine_1.default.UISprite);
        this.buttonPos = this.entity.transform2D.worldPosition.clone();
        this.buttonRadius = { x: this.entity.transform2D.size.x / 2, y: this.entity.transform2D.size.y / 2 };
    };
    ButtMove.prototype.onEnable = function () {
        this.uiInput = this.getComponent(engine_1.default.TouchInputComponent);
        if (this.uiInput) {
            this.uiInput.onTouchStart.add(this.onTouchStart);
            this.uiInput.onTouchEnter.add(this.onTouchEnter);
            this.uiInput.onTouchEnd.add(this.onTouchEnd);
            this.uiInput.onTouchLeave.add(this.onTouchLeave);
            this.uiInput.onTouchMove.add(this.onTouchMove);
        }
    };
    ButtMove.prototype.onDisable = function () {
        if (this.uiInput) {
            this.uiInput.onTouchStart.remove(this.onTouchStart);
            this.uiInput.onTouchEnter.remove(this.onTouchEnter);
            this.uiInput.onTouchEnd.remove(this.onTouchEnd);
            this.uiInput.onTouchLeave.remove(this.onTouchLeave);
            this.uiInput.onTouchMove.remove(this.onTouchMove);
        }
    };
    ButtMove.prototype.onTouchStart = function (s, e) {
        this.setAlpha(200);
        this.handleTouch(e);
    };
    ButtMove.prototype.onTouchEnter = function (s, e) {
        this.setAlpha(200);
        this.handleTouch(e);
    };
    ButtMove.prototype.onTouchMove = function (s, e) {
        this.handleTouch(e);
    };
    ButtMove.prototype.onTouchLeave = function (s, e) {
        this.setAlpha(255);
        this.emitDirection({ x: 0, y: 0, z: 0 });
    };
    ButtMove.prototype.onTouchEnd = function (s, e) {
        this.setAlpha(255);
        this.emitDirection({ x: 0, y: 0, z: 0 });
    };
    ButtMove.prototype.handleTouch = function (e) {
        this.direction.x = e.touches[0].position.x / this.buttonRadius.x;
        this.direction.y = e.touches[0].position.y / this.buttonRadius.y;
        this.emitDirection({ x: this.direction.x, y: 0, z: -this.direction.y });
    };
    ButtMove.prototype.setAlpha = function (val) {
        var c = this.uisprite.color.clone();
        c.a = val;
        this.uisprite.color = c;
    };
    ButtMove.prototype.emitDirection = function (direction) {
        eventCenter_1.default.emit(eventCenter_1.default.TOUCH_MOVE, direction);
    };
    ButtMove = tslib_1.__decorate([
        engine_1.default.decorators.serialize("ButtMove")
    ], ButtMove);
    return ButtMove;
}(engine_1.default.Script));
exports.default = ButtMove;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFzc2V0cy9TY3JpcHRzL0J1dHRNb3ZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLGlDQUE0QjtBQUc1Qiw2Q0FBd0M7QUFFeEMsSUFBTSxZQUFZLEdBQUcsZ0JBQU0sQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDO0FBQy9DLElBQU0sYUFBYSxHQUFHLGdCQUFNLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQztBQUNqRCxJQUFNLFVBQVUsR0FBRyxnQkFBTSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUM7QUFDaEQsSUFBTSxXQUFXLEdBQUcsZ0JBQU0sQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDO0FBR2xEO0lBQXNDLG9DQUFhO0lBT2pELGtCQUE0QixNQUFnQjtRQUE1QyxZQUNFLGtCQUFNLE1BQU0sQ0FBQyxTQU1kO1FBUDJCLFlBQU0sR0FBTixNQUFNLENBQVU7UUFOckMsZUFBUyxHQUFHLGdCQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN4QyxrQkFBWSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDOUIsZUFBUyxHQUFHLGdCQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN4QyxjQUFRLEdBQUcsSUFBSSxDQUFDO1FBQ2hCLGFBQU8sR0FBc0MsSUFBSSxDQUFDO1FBSXZELEtBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLENBQUM7UUFDakQsS0FBSSxDQUFDLFlBQVksR0FBRyxLQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsQ0FBQztRQUNqRCxLQUFJLENBQUMsV0FBVyxHQUFHLEtBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQyxDQUFDO1FBQy9DLEtBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSSxDQUFD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SUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFFTSxnQ0FBYSxHQUFwQixVQUFxQixTQUErQztRQUNsRSxxQkFBVyxDQUFDLElBQUksQ0FBQyxxQkFBVyxDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUN0RCxDQUFDO0lBaEZrQixRQUFRO1FBRDVCLGdCQUFNLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUM7T0FDbkIsUUFBUSxDQWtGNUI7SUFBRCxlQUFDO0NBbEZELEFBa0ZDLENBbEZxQyxnQkFBTSxDQUFDLE1BQU0sR0FrRmxEO2tCQWxGb0IsUUFBUSIsImZpbGUiOiJBc3NldHMvU2NyaXB0cy9CdXR0TW92ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBlbmdpbmUgZnJvbSBcImVuZ2luZVwiO1xuaW1wb3J0IHsgVG91Y2hJbnB1dEV2ZW50IH0gZnJvbSBcImVuZ2luZS9pbnB1dC90b3VjaFwiO1xuaW1wb3J0IHsgRW50aXR5MkQgfSBmcm9tIFwiZW5naW5lL3NjZW5lL3NjZW5lXCI7XG5pbXBvcnQgRXZlbnRDZW50ZXIgZnJvbSBcIi4vZXZlbnRDZW50ZXJcIjtcblxuY29uc3QgU0NSRUVOX1dJRFRIID0gZW5naW5lLmRldmljZS5zY3JlZW5XaWR0aDtcbmNvbnN0IFNDUkVFTl9IRUlHSFQgPSBlbmdpbmUuZGV2aWNlLnNjcmVlbkhlaWdodDtcbmNvbnN0IEdBTUVfV0lEVEggPSBlbmdpbmUuYWRhcHRhdGlvbi5mcmFtZVdpZHRoO1xuY29uc3QgR0FNRV9IRUlHSFQgPSBlbmdpbmUuYWRhcHRhdGlvbi5mcmFtZUhlaWdodDtcblxuQGVuZ2luZS5kZWNvcmF0b3JzLnNlcmlhbGl6ZShcIkJ1dHRNb3ZlXCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCdXR0TW92ZSBleHRlbmRzIGVuZ2luZS5TY3JpcHQge1xuICBwdWJsaWMgYnV0dG9uUG9zID0gZW5naW5lLlZlY3RvcjIuWkVSTy5jbG9uZSgpOyAvLyDmjInpkq7nmoRjYW52YXPlnZDmoIdcbiAgcHVibGljIGJ1dHRvblJhZGl1cyA9IHsgeDogMCwgeTogMCB9O1xuICBwdWJsaWMgZGlyZWN0aW9uID0gZW5naW5lLlZlY3RvcjIuWkVSTy5jbG9uZSgpO1xuICBwdWJsaWMgdWlzcHJpdGUgPSBudWxsO1xuICBwdWJsaWMgdWlJbnB1dDogZW5naW5lLlRvdWNoSW5wdXRDb21wb25lbnQgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVhZG9ubHkgZW50aXR5OiBFbnRpdHkyRCkge1xuICAgIHN1cGVyKGVudGl0eSk7XG4gICAgdGhpcy5vblRvdWNoU3RhcnQgPSB0aGlzLm9uVG91Y2hTdGFydC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25Ub3VjaEVudGVyID0gdGhpcy5vblRvdWNoRW50ZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uVG91Y2hNb3ZlID0gdGhpcy5vblRvdWNoTW92ZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25Ub3VjaEVuZCA9IHRoaXMub25Ub3VjaEVuZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25Ub3VjaExlYXZlID0gdGhpcy5vblRvdWNoTGVhdmUuYmluZCh0aGlzKTtcbiAgfVxuICBwdWJsaWMgb25Bd2FrZSgpIHtcbiAgICB0aGlzLnVpc3ByaXRlID0gdGhpcy5lbnRpdHkuZ2V0Q29tcG9uZW50KGVuZ2luZS5VSVNwcml0ZSk7XG4gICAgdGhpcy5idXR0b25Qb3MgPSB0aGlzLmVudGl0eS50cmFuc2Zvcm0yRC53b3JsZFBvc2l0aW9uLmNsb25lKCk7XG4gICAgdGhpcy5idXR0b25SYWRpdXMgPSB7IHg6IHRoaXMuZW50aXR5LnRyYW5zZm9ybTJELnNpemUueCAvIDIsIHk6IHRoaXMuZW50aXR5LnRyYW5zZm9ybTJELnNpemUueSAvIDIgfTtcbiAgfVxuXG4gIHB1YmxpYyBvbkVuYWJsZSgpOiB2b2lkIHtcbiAgICB0aGlzLnVpSW5wdXQgPSB0aGlzLmdldENvbXBvbmVudDxlbmdpbmUuVG91Y2hJbnB1dENvbXBvbmVudD4oZW5naW5lLlRvdWNoSW5wdXRDb21wb25lbnQpO1xuICAgIGlmICh0aGlzLnVpSW5wdXQpIHtcbiAgICAgIHRoaXMudWlJbnB1dC5vblRvdWNoU3RhcnQuYWRkKHRoaXMub25Ub3VjaFN0YXJ0KTtcbiAgICAgIHRoaXMudWlJbnB1dC5vblRvdWNoRW50ZXIuYWRkKHRoaXMub25Ub3VjaEVudGVyKTtcbiAgICAgIHRoaXMudWlJbnB1dC5vblRvdWNoRW5kLmFkZCh0aGlzLm9uVG91Y2hFbmQpO1xuICAgICAgdGhpcy51aUlucHV0Lm9uVG91Y2hMZWF2ZS5hZGQodGhpcy5vblRvdWNoTGVhdmUpO1xuICAgICAgdGhpcy51aUlucHV0Lm9uVG91Y2hNb3ZlLmFkZCh0aGlzLm9uVG91Y2hNb3ZlKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgb25EaXNhYmxlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnVpSW5wdXQpIHtcbiAgICAgIHRoaXMudWlJbnB1dC5vblRvdWNoU3RhcnQucmVtb3ZlKHRoaXMub25Ub3VjaFN0YXJ0KTtcbiAgICAgIHRoaXMudWlJbnB1dC5vblRvdWNoRW50ZXIucmVtb3ZlKHRoaXMub25Ub3VjaEVudGVyKTtcbiAgICAgIHRoaXMudWlJbnB1dC5vblRvdWNoRW5kLnJlbW92ZSh0aGlzLm9uVG91Y2hFbmQpO1xuICAgICAgdGhpcy51aUlucHV0Lm9uVG91Y2hMZWF2ZS5yZW1vdmUodGhpcy5vblRvdWNoTGVhdmUpO1xuICAgICAgdGhpcy51aUlucHV0Lm9uVG91Y2hNb3ZlLnJlbW92ZSh0aGlzLm9uVG91Y2hNb3ZlKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgb25Ub3VjaFN0YXJ0KHM6IGVuZ2luZS5Ub3VjaElucHV0Q29tcG9uZW50LCBlOiBUb3VjaElucHV0RXZlbnQpIHtcbiAgICB0aGlzLnNldEFscGhhKDIwMCk7XG4gICAgdGhpcy5oYW5kbGVUb3VjaChlKTtcbiAgfVxuXG4gIHB1YmxpYyBvblRvdWNoRW50ZXIoczogZW5naW5lLlRvdWNoSW5wdXRDb21wb25lbnQsIGU6IFRvdWNoSW5wdXRFdmVudCkge1xuICAgIHRoaXMuc2V0QWxwaGEoMjAwKTtcbiAgICB0aGlzLmhhbmRsZVRvdWNoKGUpO1xuICB9XG5cbiAgcHVibGljIG9uVG91Y2hNb3ZlKHM6IGVuZ2luZS5Ub3VjaElucHV0Q29tcG9uZW50LCBlOiBUb3VjaElucHV0RXZlbnQpIHtcbiAgICB0aGlzLmhhbmRsZVRvdWNoKGUpO1xuICB9XG5cbiAgcHVibGljIG9uVG91Y2hMZWF2ZShzOiBlbmdpbmUuVG91Y2hJbnB1dENvbXBvbmVudCwgZTogVG91Y2hJbnB1dEV2ZW50KSB7XG4gICAgdGhpcy5zZXRBbHBoYSgyNTUpO1xuICAgIHRoaXMuZW1pdERpcmVjdGlvbih7IHg6IDAsIHk6IDAsIHo6IDAgfSk7XG4gIH1cblxuICBwdWJsaWMgb25Ub3VjaEVuZChzOiBlbmdpbmUuVG91Y2hJbnB1dENvbXBvbmVudCwgZTogVG91Y2hJbnB1dEV2ZW50KSB7XG4gICAgdGhpcy5zZXRBbHBoYSgyNTUpO1xuICAgIHRoaXMuZW1pdERpcmVjdGlvbih7IHg6IDAsIHk6IDAsIHo6IDAgfSk7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlVG91Y2goZTogVG91Y2hJbnB1dEV2ZW50KSB7XG4gICAgdGhpcy5kaXJlY3Rpb24ueCA9IGUudG91Y2hlc1swXS5wb3NpdGlvbi54IC8gdGhpcy5idXR0b25SYWRpdXMueDtcbiAgICB0aGlzLmRpcmVjdGlvbi55ID0gZS50b3VjaGVzWzBdLnBvc2l0aW9uLnkgLyB0aGlzLmJ1dHRvblJhZGl1cy55O1xuICAgIHRoaXMuZW1pdERpcmVjdGlvbih7IHg6IHRoaXMuZGlyZWN0aW9uLngsIHk6IDAsIHo6IC10aGlzLmRpcmVjdGlvbi55IH0pO1xuICB9XG5cbiAgcHVibGljIHNldEFscGhhKHZhbDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgYyA9IHRoaXMudWlzcHJpdGUuY29sb3IuY2xvbmUoKTtcbiAgICBjLmEgPSB2YWw7XG4gICAgdGhpcy51aXNwcml0ZS5jb2xvciA9IGM7XG4gIH1cblxuICBwdWJsaWMgZW1pdERpcmVjdGlvbihkaXJlY3Rpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHo6IG51bWJlcjsgfSk6IHZvaWQge1xuICAgIEV2ZW50Q2VudGVyLmVtaXQoRXZlbnRDZW50ZXIuVE9VQ0hfTU9WRSwgZGlyZWN0aW9uKTtcbiAgfVxuXG59XG4iXX0=
